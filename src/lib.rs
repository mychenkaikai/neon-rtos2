//! # Neon-RTOS2
//!
//! 一个使用 Rust 语言开发的嵌入式实时操作系统（RTOS），专为资源受限的嵌入式系统设计。
//!
//! ## 特性
//!
//! - 🦀 **纯 Rust 实现**: 充分利用 Rust 的类型系统和内存安全特性
//! - 📦 **no_std 支持**: 适用于资源受限的嵌入式系统
//! - ⚡ **实时调度**: 支持优先级调度和抢占式任务切换
//! - 🔒 **同步原语**: 互斥锁（RAII）、信号量、事件等
//! - 📬 **进程间通信**: 消息队列和类型安全通道
//! - ⏱️ **定时器系统**: 软件定时器和延时功能
//! - 🎯 **Builder 模式**: 链式 API 创建任务
//! - 🔄 **迭代器支持**: 函数式风格遍历任务
//!
//! ## 支持平台
//!
//! - ✅ Cortex-M3（已实现）
//! - 📝 RISC-V（计划中）
//!
//! ## 快速开始
//!
//! ```rust,ignore
//! use neon_rtos2::prelude::*;
//!
//! fn main() {
//!     // 初始化内核
//!     kernel_init();
//!
//!     // 创建任务（Builder 模式）
//!     let task = Task::builder("my_task")
//!         .priority(Priority::High)
//!         .spawn(|_| {
//!             loop {
//!                 info!("Task running");
//!                 Delay::delay(1000).unwrap();
//!             }
//!         }).unwrap();
//!
//!     // 启动调度器
//!     Scheduler::start();
//! }
//! ```
//!
//! ## 架构分层
//!
//! ```text
//! ┌─────────────────────────────────────────────────────────────┐
//! │                      用户应用层                              │
//! ├─────────────────────────────────────────────────────────────┤
//! │                      API 层 (prelude)                       │
//! │              统一导出、Builder 模式、迭代器                   │
//! ├─────────────────────────────────────────────────────────────┤
//! │                      服务层                                  │
//! │       kernel/（任务调度）  sync/（同步）  ipc/（通信）        │
//! ├─────────────────────────────────────────────────────────────┤
//! │                      基础设施层                              │
//! │       mem/（内存）  error/（错误）  log/（日志）             │
//! ├─────────────────────────────────────────────────────────────┤
//! │                   硬件抽象层 (hal/)                          │
//! │              cortex_m3/  |  riscv/ (计划中)                 │
//! └─────────────────────────────────────────────────────────────┘
//! ```
//!
//! ## 模块结构
//!
//! | 模块 | 说明 |
//! |------|------|
//! | [`kernel`] | 内核核心（任务管理、调度器、时间管理） |
//! | [`sync`] | 同步原语（互斥锁、信号量、事件） |
//! | [`ipc`] | 进程间通信（消息队列、类型安全通道） |
//! | [`hal`] | 硬件抽象层（Cortex-M3、测试模拟） |
//! | [`mem`] | 内存管理（堆分配器） |
//! | [`error`] | 错误类型定义（`RtosError`） |
//! | [`config`] | 系统配置常量 |
//! | [`log`] | 日志系统（多级别日志） |
//! | [`prelude`] | 常用类型统一导出 |
//!
//! ## Prelude 导出
//!
//! 推荐使用 `prelude` 模块一次性导入所有常用类型：
//!
//! ```rust,ignore
//! use neon_rtos2::prelude::*;
//! ```
//!
//! 导出内容包括：
//! - **任务管理**: `Task`, `TaskBuilder`, `TaskState`, `Priority`, `TaskIter`
//! - **调度器**: `Scheduler`
//! - **时间管理**: `Timer`, `Delay`, `Systick`
//! - **同步原语**: `Mutex`, `MutexGuard`, `Signal`, `Event`
//! - **进程间通信**: `Mq`, `Ipc`, `IpcHandle`
//! - **错误处理**: `Result`, `RtosError`
//! - **日志**: `LogLevel`, `set_log_level`, `get_log_level`
//! - **工具函数**: `kernel_init`
//!
//! ## 文档
//!
//! 详细文档请参阅 `docs/` 目录：
//! - `docs/API_GUIDE.md` - API 使用指南
//! - `docs/ARCHITECTURE.md` - 架构设计文档
//! - `docs/PROGRESS_REPORT.md` - 开发进度报告

#![cfg_attr(not(test), no_std)]
#![cfg_attr(not(test), no_main)]

#[cfg(test)]
extern crate std;
extern crate alloc;

// ============================================================================
// 核心模块
// ============================================================================

/// 错误类型定义
pub mod error;

/// 内核核心模块
pub mod kernel;

/// 同步原语
pub mod sync;

/// 进程间通信
pub mod ipc;

/// 硬件抽象层
pub mod hal;

/// 内存管理
pub mod mem;

/// 系统配置
pub mod config;

/// 日志系统
pub mod log;

/// 工具函数
pub mod utils;

/// 常用类型统一导出
pub mod prelude;

/// 异步运行时
pub mod runtime;

// ============================================================================
// 重新导出
// ============================================================================

/// 宏辅助工具
pub use paste;
